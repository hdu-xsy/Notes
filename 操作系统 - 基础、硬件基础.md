# 操作系统
### 概念
- 负责管理协调硬件、软件等计算机资源的工作
- 为上层用户、应用程序提供简单易用的服务
- 是一种系统软件

### 功能和目标
- 资源的管理者
  - 处理机管理
  - 存储器管理
  - 文件管理
  - 设备管理
- 向用户提供服务
  - 命令接口(联机/脱机)
  - 程序接口
  - GUI用户图形界面
- 对硬件机器的扩展

### 特征
- 并发 
- 共享(互斥/同步)
- 虚拟(空分复用技术/时分复用技术)
- 异步

### 发展和分类
- 手工操作阶段：人机速度矛盾
- 批处理阶段
  - 单道批处理系统（引入脱机输入输出技术）：缓解人机速度矛盾、资源利用率低
  - 多道批处理系统（操作系统开始出现）：多道程序并发执行，资源利用率高、不提供人机交互功能 
- 分时操作系统：提供人机交互功能、不能优先处理紧急任务
- 实时操作系统：能优先处理紧急任务
- 网络操作系统
- 分布式操作系统
- 个人计算机操作系统

### 内核
- 时钟管理（实现计时功能）
- 中断处理（实现中断机制）
- 原语（是一种特殊的程序、处于操作系统的最底层、具有原子性、运行时间短调用频繁）
- 对系统资源进行管理（进程管理、存储器管理、设备管理）

# 操作系统硬件基础

## 处理器计算
### 处理器指令 
`每条计算机指令必须包含处理器执行所需的信息:操作码、源操作数、目的操作数和下一条指令地址`

- 操作码 `指令要完成的具体操作`
- 源操作数 `具体操作所需要的输入`
- 目的操作数 `具体操作的结果`
- 下一条指令地址 `当前这条指令执行完成后去哪里取下一条指令`

### 寻址方式
- 两条指令寻址方式
  - 顺序寻址方式 `指令一般顺序的存储在内存中，当执行一段程序中，通常是一条指令接一条指令地顺序取址执行`
  - 跳跃寻址方式 `当程序执行转移或者函数调用等相关指令时，需要改变顺序执行模式，那么指令的寻址就会采取跳跃寻址方式。可以实现程序转移，构成循环程序`
- 数据寻址方式
  - 隐含寻址 `指令中隐含着操作数的地址`
  - 立即寻址 `指令的地址字段指出的是操作数本身`
  - 直接寻址 `在指令的地址字段中直接给出操作数的地址及运算结果的存放地址`
  - 间接寻址 `指令地址字段中的地址不是操作数的真正地址，而是操作数地址的指示器`
  - 寄存器寻址方式和寄存器间接寻址方式 `操作数放在cpu的通用寄存器中`
  - 相对寻址方式 `指令中给出的操作数地址其实是操作数位置相对于当前指令位置的偏移量`
  - 基址寻址方式 `CPU中的基址寄存器的内容，加上变址寄存器的内容形成操作数的地址`
  - 变址寻址方式 `CPU中某个变址寄存器的内容与偏移量相加来形成操作数地址`
  - 块寻址方式 `经常用在输入输出指令中，以实现外存储器或外围设备同内存之间的数据块传送`

###  寄存器
`寄存器是中央处理器的组成成分，是有限存储容量的高速存储部件，可用来暂存指令、数据和地址。`

- 寄存器分类
  - 数据寄存器 `储存整数数字`
  - 地址寄存器 `存放存储器地址`
  - 通用目的寄存器(GPRs) `保存数据或地址`
  - 浮点寄存器(FRPs) `储存浮点数据`
  - 常数寄存器 `存放只读的数值`
  - 向量寄存器 `储存由向量处理器运行SIMD指令所得到的数据`
  - 特殊目的寄存器 `储存CPU内部的数据`
  - 指令寄存器 `储存当前正在被执行的指令`
  - 索引寄存器 `用于在程序运行过程中更改运算对象的地址`

- X86寄存器
  - 通用寄存器
  - 指令指针EIP
  - 标志寄存器EFR
  - 段寄存器

## 存储系统
`存储系统是指计算机中由存放程序和数据的各种存储设备、控制部件及管理信息调度的设备（硬件）和算法（软件）所组成的系统`

### 高速缓存存储器Cache
- 组成结构
  - Cache存储体
  - 地址转换部件
  - 置换部件
- 工作原理
- 地址映象与转换
  - 全相联方式
  - 直接相联方式
  - 组相联映象方式
### 内存
- 只读存储器ROM
- 随机存储器RAM
### 堆栈
- 堆栈相关基础知识
- 函数调用过程中堆栈的使用过程
### 磁盘
- 硬磁盘的种类和构成
- 硬磁盘的工作原理
  - 盘面
  - 磁道
  - 柱面
  - 扇区
### 非易失性存储
### 局部性原理
- 时间局部性
- 空间局部性

## 中断和时钟
### 中断和异常
- 中断的基本概念`中断是指计算机运行过程中，出现某些意外情况需主机干预时，机器能自动暂停正在运行的程序并转入处理新情况的程序，处理完毕后又返回原被暂停的程序继续运行` `程序运行过程中，如果系统外部、系统内部或者当前运行程序本身出现紧急事件，处理机将立即暂停当前程序的运行，自动转入相应的处理程序（中断服务程序），待处理完毕完后，再返回原来的程序运行，这整个过程成为程序中断``中断是CPU从用户态进入核心态的唯一途径`

- 现代计算机中采用中断系统的主要目的
  - 提高计算机系统效率
  - 维持系统可靠正常工作
  - 满足实时处理要求
  - 提供故障现场处理手段
- 中断的分类
  - 中断（外中断）　
    - 外设请求
    - 人工干预 
  - 异常（内中断）
     - 处理器探测异常
         - 故障trap
         - 陷阱fault
         - 异常中止abort
     - 编程异常
- 外中断处理过程
  - 每条指令执行结束后，CPU检查是否有外部中断信号
  - 若有外部中断信号，则需要保护被中断进程的CPU环境
  - 根据中断信号类型转入相应的中断处理程序
  - 恢复原进程的CPU环境并退出中断，返回原进程继续往下执行 
- 中断向量
- 中断描述符表
  - 中断门
  - 陷阱门
  - 系统门
- 传统的中断控制器：8259A
### 计算机系统时钟
- 实时时钟 RTC
- 时间戳计数器 TSC
- 可编程间隔定时器 PIT